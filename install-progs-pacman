#!/usr/bin/env bash
set -euo pipefail


[ "$EUID" -ne 0 ] && { echo "Pacman must be run this as root"; exit 1; }

#################################################
# some of this could see some cleanup
################################################

# autocomplete / checks for various langs for Helix (or other editors)
lsp=(
	texlab
	python-lsp-server
	svelte-language-server
	haskell-language-server
	bash-language-server
)

web_browsers=(
	firefox  firefox-tridactyl  firefox-ublock-origin 
	chromium 
	qutebrowser
)

# todo: cleanup / split
guiutils=(
	xdotool xclip xcolor
	wl-clipboard
	network-manager-applet dmenu rofi rpi-imager xdot timeshift uget meld
	debugedit picom libspeechd speech-dispatcher numlockx dunst xf86-video-intel unclutter redshift dex
	wine winetricks
	# bluetooth?
	qt5-connectivity qt6-connectivity
)

cliutils=(
	wget curl aria2 fd fzf kexec-tools brightnessctl cpupower zip p7zip pass parallel ccache less man
	# bluetooth
	bluez-utils 
)

programming=(
	git imagemagick alacritty htop shellcheck intel-gpu-tools jdk21-openjdk tcc valgrind tmux byobu vim helix clang bcc-tools
)

rice=(
	polybar i3 sxhkd bspwm
)

media=(
	yt-dlp pamixer sxiv mpv xwallpaper lf ueberzug zathura zathura-ps zathura-djvu zathura-pdf-mupdf maim
)

fonts=(
	ttf-jetbrains-mono ttf-jetbrains-mono-nerd noto-fonts-cjk
)

texlive_all=(
	texlive texlive-lang tectonic
)


guionly=(
	"${web_browsers[@]}" 
	"${media[@]}" 
	"${rice[@]}" 
	"${fonts[@]}" 
	"${wine[@]}"
	"${guiutils[@]}"
)
clionly=(
	"${programming[@]}" 
	"${lsp[@]}" 
	"${cliutils[@]}"
)

case "${1:-}" in
    cli) everything=("${clionly[@]}");;
    gui) everything=("${clionly[@]}" "${guionly[@]}");;
    guiplustex) everything=( "${guionly[@]}" "${clionly[@]}" "${texlive_all[@]}" );;
    *) echo "usage: $0 cli/gui/guiplustex"; exit 1;;
esac

pacman -Syu --noconfirm --needed "${everything[@]}"
# pacman -Fy  -- like 50M, shouldn't be updated every 5 minutes

