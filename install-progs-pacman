#!/bin/bash
set -euo pipefail


[ "$EUID" -ne 0 ] && { echo "Pacman must be run this as root"; exit 1; }

# autocomplete / checks for various langs for Helix (or other editors)
lsp=(texlab python-lsp-server svelte-language-server haskell-language-server bash-language-server)
# self-explanatory
web_browsers=(firefox firefox-tridactyl firefox-ublock-origin chromium qutebrowser)
# things which you can click on in a graphical environment
gui_utils=(network-manager-applet dmenu rofi rpi-imager xdot timeshift uget meld)
# text-based tools which still need the X server
cli_utils_x11=(xdotool xclip xcolor)
# things runnable from the console (maybe move this to programming?)
cli_utils_con=(wget curl aria2 fd fzf kexec-tools brightnessctl cpupower zip p7zip pass parallel ccache less man)
# non-interactive components
gui_lowlevel=(debugedit picom libspeechd speech-dispatcher numlockx dunst xf86-video-intel unclutter redshift dex)
# various prog tools / compilers / runtimes, strictly for programming
programming=(git imagemagick alacritty htop shellcheck intel-gpu-tools jdk21-openjdk tcc valgrind tmux byobu vim helix clang bcc-tools)
# niche things for weird people
rice=(polybar i3 sxhkd bspwm)
# text / audio / video viewers
media=(yt-dlp pamixer sxiv mpv xwallpaper lf ueberzug zathura zathura-ps zathura-djvu zathura-pdf-mupdf maim)
# font packs
fonts=(ttf-jetbrains-mono ttf-jetbrains-mono-nerd)
# 4 GB of junk, thanks Mr Lamport
texlive_all=(texlive texlive-lang)
wine=(wine winetricks)

guionly=("${web_browsers[@]}" "${gui_utils[@]}" "${cli_utils_x11[@]}" "${media[@]}" "${rice[@]}" "${fonts[@]}" "${gui_lowlevel[@]}" "${wine[@]}")
clionly=("${programming[@]}" "${lsp[@]}" "${cli_utils_con[@]}")

case "$1" in
    cli) everything=("${clionly[@]}");;
    gui) everything=("${clionly[@]}" "${guionly[@]}");;
    guiplustex) everything=( "${guionly[@]}" "${clionly[@]}" "${texlive_all[@]}" );;
    *) echo "usage: $0 cli/gui/guiplustex";;
esac

pacman -Syu --noconfirm --needed "${everything[@]}"
# pacman -Fy  -- like 50M, shouldn't be updated every 5 minutes

